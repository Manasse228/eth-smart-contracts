<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/Crowdfund.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> Crowdfund.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">76.27% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>45/59</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">55.26% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>21/38</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">66.67% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>10/15</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">76.56% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>49/64</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity ^0.4.15;
&nbsp;
import "./library/SafeMath.sol";
import "./library/CanReclaimToken.sol";
import "./library/NonZero.sol";
import "./Token.sol";
&nbsp;
&nbsp;
contract Crowdfund is NonZero, CanReclaimToken {
&nbsp;
    using SafeMath for uint;
&nbsp;
/////////////////////// VARIABLE INITIALIZATION ///////////////////////
    // Amount of wei currently raised
    uint256 public weiRaised = 0;
    // UNIX timestamp of when the crowdfund starts
    uint256 public startsAt;
    // UNIX timestamp of when the crowdfund ends
    uint256 public endsAt;
    // Instance of the Fuel token contract
    Token public token;
    // Whether the crowdfund is in a "Ready to activate" state
    bool public isActivated = false;
    // Flag keeping track of crowdsale status. Ensures closeCrowdfund() and kill() can only be called once
    bool public crowdfundFinalized = false;
&nbsp;
&nbsp;
    // Our own vars
    // Address of secure wallet to send ETH/SBTC crowdfund contributions to
    address public wallet;
    // Address to forward the tokens to at the end of the Crowdfund
    address public forwardTokensTo;
    // Total length of the crowdfund
    uint256 public crowdfundLength;
    // Total amount of days
    uint256 public totalDays;
&nbsp;
&nbsp;
    struct rate {
        uint256 price;
        uint256 amountOfDays;
    }
&nbsp;
    // Array of token rates for each epochs
    rate[] public rates;
&nbsp;
/////////////////////// EVENTS ///////////////////////
&nbsp;
    // Emmitted upon purchasing tokens
    event TokenPurchase(address indexed purchaser, uint256 value, uint256 amount);
&nbsp;
/////////////////////// MODIFIERS ///////////////////////
&nbsp;
    // Ensure the crowdfund is ongoing
    modifier crowdfundIsActive() {
        assert(now &gt;= startsAt &amp;&amp; now &lt;= endsAt);
        _;
    }
&nbsp;
    // Ensure actions can only happen after crowdfund ends
    modifier onlyAfterCrowdfund() {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(now &gt;= endsAt);
        _;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    modifier onlyBeforeCrowdfund(</span>) {
<span class="cstat-no" title="statement not covered" >        require(now &lt;= startsAt)</span>;
        _;
    }
/////////////////////// CROWDFUND FUNCTIONS ///////////////////////
    /**
     * @dev Constructor
     * @param _owner The address of the contract owner
     */
    function Crowdfund(
        address _owner,                     // Owner of the crowdfund contract
        uint256[] memory epochs,            // Array of the length of epoch per specific token price (in days)
        uint256[] memory prices,            // Array of the prices for each price epoch
        address _wallet,                    // Wallet address
        address _forwardTokensTo,           // Address to forward the tokens to
        uint256 _totalDays,                 // Length of the crowdfund in days
        uint256 _totalSupply,               // Total Supply of the token
        address[] memory _allocAddresses,   // Array of allocation addresses
        uint256[] memory _allocBalances,    // Array of allocation balances
        uint256[] memory _timelocks         // Array of timelocks for all the allocations
        ) public {
&nbsp;
        wallet = _wallet;
        // Change the owner to the owner address.
        owner = _owner;
        forwardTokensTo = _forwardTokensTo;
        totalDays = _totalDays;
        crowdfundLength = _totalDays.mul(1 days);
&nbsp;
        // Ensure the prices per epoch passed in are the same length and limit the size of the array
        <span class="missing-if-branch" title="else path not taken" >E</span>assert(epochs.length == prices.length &amp;&amp; prices.length &lt; 10);
        // Keep track of the amount of days -- this will determine which epoch we are in
        uint256 totalAmountOfDays = 0;
        // Push all of them to the rates array
        for (uint8 i = 0; i &lt; epochs.length; i++) {
            totalAmountOfDays = totalAmountOfDays.add(epochs[i]);
            rates.push(rate(prices[i], totalAmountOfDays));
        }
        <span class="missing-if-branch" title="else path not taken" >E</span>assert(totalAmountOfDays == totalDays);
&nbsp;
        // // Create the token contract
        token = new Token(owner, _totalSupply, _allocAddresses, _allocBalances, _timelocks); // Create new Token
&nbsp;
    }
&nbsp;
    /**
     * @dev Called by the owner or the contract at the start of the crowdfund
     * @param _startDate The start date UNIX timestamp
     */
    function scheduleCrowdfund(uint256 _startDate) public onlyOwner returns(bool) {
        // crowdfund cannot be already activated
        require(isActivated == false);
        startsAt = _startDate;
        endsAt = startsAt + crowdfundLength;
        isActivated = true;
        assert(startsAt &gt;= now &amp;&amp; endsAt &gt; startsAt);
        return true;
    }
&nbsp;
    /**
     * @dev Called by the owner of the contract to reschedule the start of the crowdfund
     * @param _startDate The start date UNIX timestamp
     */
    function reScheduleCrowdfund(uint256 _startDate) public onlyOwner returns(bool) {
        // We require this function to only be called before the crowfund starts
        require(now &lt; startsAt &amp;&amp; isActivated == true);
        startsAt = _startDate;
        endsAt = startsAt + crowdfundLength;
        <span class="missing-if-branch" title="else path not taken" >E</span>assert(startsAt &gt;= now &amp;&amp; endsAt &gt; startsAt);
        return true;
    }
&nbsp;
    /**
     * @dev Change the main contribution wallet
     * @param _wallet The new contribution wallet address
     */
    function changeWalletAddress(address _wallet) public onlyOwner nonZeroAddress(_wallet) {
        wallet = _wallet;
    }
&nbsp;
    /**
     * @dev Change the main contribution wallet
     * @param _forwardTokensTo The new contribution wallet address
     */
    function changeForwardAddress(address _forwardTokensTo) public onlyOwner nonZeroAddress(_forwardTokensTo) {
        forwardTokensTo = _forwardTokensTo;
    }
&nbsp;
    /**
     * @dev Buys tokens at the current rate
     * @param _to The address the bought tokens are sent to
     */
    function buyTokens(address _to) public crowdfundIsActive nonZeroAddress(_to) nonZeroValue payable {
        uint256 weiAmount = msg.value;
        uint256 tokens = weiAmount.mul(getRate());
        weiRaised = weiRaised.add(weiAmount);
        wallet.transfer(weiAmount);
        <span class="missing-if-branch" title="if path not taken" >I</span>if (!token.moveAllocation(_to, tokens)) {
<span class="cstat-no" title="statement not covered" >            revert()</span>;
        }
        TokenPurchase(_to, weiAmount, tokens);
    }
&nbsp;
    /**
     * @dev Closes the crowdfund only after the crowdfund ends and by the owner
     * @return bool True if closed successfully else false
     */
    function closeCrowdfund() external onlyAfterCrowdfund onlyOwner returns (bool success) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(crowdfundFinalized == false);
        var (amount,) = token.allocations(this);
        <span class="missing-if-branch" title="else path not taken" >E</span>if (amount &gt; 0) {
            // Transfer all of the tokens out to the final address (if burning, send to 0x0)
            <span class="missing-if-branch" title="if path not taken" >I</span>if (!token.moveAllocation(forwardTokensTo, amount)) {
<span class="cstat-no" title="statement not covered" >                revert()</span>;
            }
        }
        // Unlock the tokens
        <span class="missing-if-branch" title="if path not taken" >I</span>if (!token.unlockTokens()) {
<span class="cstat-no" title="statement not covered" >            revert()</span>;
        }
        crowdfundFinalized = true;
        return true;
    }
&nbsp;
/////////////////////// CONSTANT FUNCTIONS ///////////////////////
    /**
     * @dev Returns token rate depending on the current time
     * @return uint The price of the token rate per 1 ETH
     */
    function getRate() public constant returns (uint price) { // This one is dynamic, would have multiple rounds
        // Calculate the amount of days passed (division truncates)
        uint256 daysPassed = (now.sub(startsAt)).div(1 days);
        for (uint8 i = 0; i &lt; rates.length; i++) {
        // if the days passed since the start is below the amountOfdays we use the last rate
            if (daysPassed &lt; rates[i].amountOfDays) {
                // If it's the first index, then we return its price
                if (i == 0) {
                    return rates[i].price;
                }
                // else we return its last price
                return rates[i].price;
            }
        }
        // If we reach here, means this is after the crowdfund ended
        return 0;
    }
&nbsp;
    /**
     * @dev Sends presale tokens to any contributors when called by the owner
     * @param _batchOfAddresses An array of presale contributor addresses
     * @param _amountOfTokens An array of tokens bought synchronized with the index value of _batchOfAddresses
     * @return bool True if successful else false
     */
<span class="fstat-no" title="function not covered" >    function deliverPresaleTokens(address[] _batchOfAddresses, uint[] _amountOfTokens) external onlyBeforeCrowdfund onlyOwner returns (bool success</span>) {
<span class="cstat-no" title="statement not covered" >        require(_batchOfAddresses.length == _amountOfTokens.length)</span>;
<span class="cstat-no" title="statement not covered" >        for (uint256 i = 0; i &lt; _batchOfAddresses.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            deliverPresaleToken(_batchOfAddresses[i], _amountOfTokens[i])</span>;
        }
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
     * @dev Sends token to presale address
     * @param _accountHolder Account address to send token to
     * @param _amountOfTokens Amount of tokens to send
     */
    // All presale purchases will be delivered.
<span class="fstat-no" title="function not covered" >    function deliverPresaleToken(address _accountHolder, uint256 _amountOfTokens) interna</span>l {
<span class="cstat-no" title="statement not covered" >        if (!token.moveAllocation(_accountHolder, _amountOfTokens)) {</span>
<span class="cstat-no" title="statement not covered" >            revert()</span>;
        }
    }
&nbsp;
    /**
     * @dev Called by the owner to kill the contact once the crowdfund is finished and there are no tokens left
     */
<span class="fstat-no" title="function not covered" >    function kill() external onlyOwne</span>r {
<span class="cstat-no" title="statement not covered" >        var (amount,) = token.allocations(this);</span>
<span class="cstat-no" title="statement not covered" >        require(crowdfundFinalized == true &amp;&amp; amount == 0)</span>;
<span class="cstat-no" title="statement not covered" >        selfdestruct(owner)</span>;
    }
&nbsp;
    /**
     * @dev Allows for users to send ETH to buy tokens
     */
<span class="fstat-no" title="function not covered" >    function () external payabl</span>e {
<span class="cstat-no" title="statement not covered" >        buyTokens(msg.sender)</span>;
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Mar 04 2018 17:53:58 GMT-0800 (PST)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
